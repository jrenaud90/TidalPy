""" Eccentricity functions (squared) for various truncations of e at tidal order-l = 3
"""

from typing import Tuple, Dict

import numpy as np

from TidalPy.performance import njit


@njit
def eccentricity_funcs_trunc2(eccentricity: np.ndarray) -> Dict[Tuple[int, int, int], np.ndarray]:
    """ Calculates the eccentricity functions (by mode) truncated to e^10 for order-l = 3
    Parameters
    ----------
    eccentricity : np.ndarray
        Orbital Eccentricity
    Returns
    -------
    eccentricity_results_bymode : Dict[Tuple[int, int int], np.ndarray]
    """
    # Eccentricity functions calculated at truncation level 14. Reduced to 2

    # Performance and readability improvements
    e = eccentricity
    e2  = e * e

    eccentricity_results_bymode = {
        (3, 0, -1): e2,
        (3, 0, 0):  -12.0*e2 + 1.0,
        (3, 0, 1):  25.0*e2,
        (3, 1, -1): -e2/(e2 - 1.0)**5,
        (3, 1, 0):  4.0*e2 + 1.0,
        (3, 1, 1):  9.0*e2,
        (3, 2, -1): 9.0*e2,
        (3, 2, 0):  4.0*e2 + 1.0,
        (3, 2, 1):  -e2/(e2 - 1.0)**5,
        (3, 3, -1): 25.0*e2,
        (3, 3, 0):  -12.0*e2 + 1.0,
        (3, 3, 1):  e2
    }

    return eccentricity_results_bymode

@njit
def eccentricity_funcs_trunc10(eccentricity: np.ndarray) -> Dict[Tuple[int, int, int], np.ndarray]:
    """ Calculates the eccentricity functions (by mode) truncated to e^10 for order-l = 3
    Parameters
    ----------
    eccentricity : np.ndarray
        Orbital Eccentricity
    Returns
    -------
    eccentricity_results_bymode : Dict[Tuple[int, int int], np.ndarray]
    """
    # Eccentricity functions calculated at truncation level 14. Reduced to 10

    # Performance and readability improvements
    e = eccentricity
    e2  = e * e
    e4  = e * e * e * e
    e6  = e * e * e * e * e * e
    e8  = e**8
    e10 = e**10

    eccentricity_results_bymode = {
        (3, 0, -5): 6.94444444444444e-5*e10,
        (3, 0, -4): 1.35633680555556e-5*e10 + 6.78168402777778e-6*e8,
        (3, 0, -2): 0.00393880208333333*e10 + 0.00490993923611111*e8 + 0.00520833333333333*e6 + 0.015625*e4,
        (3, 0, -1): 0.136197916666667*e10 - 0.524305555555556*e8 + 1.85416666666667*e6 - 2.5*e4 + e2,
        (3, 0, 0):  -31.233955078125*e10 + 68.0408935546875*e8 - 83.21875*e6 + 49.21875*e4 - 12.0*e2 + 1.0,
        (3, 0, 1):  1147.2109375*e10 - 1221.72222222222*e8 + 736.916666666667*e6 - 220.0*e4 + 25.0*e2,
        (3, 0, 2):  -11511.4770507813*e10 + 6597.1491156684*e8 - 2027.36979166667*e6 + 252.015625*e4,
        (3, 0, 3):  43691.82890625*e10 - 13126.59375*e8 + 1660.5625*e6,
        (3, 0, 4):  -68154.558710395*e10 + 8504.77816433377*e8,
        (3, 0, 5):  36828.8084027778*e10,
        (3, 1, -5): 14.0312673611111*e10,
        (3, 1, -4): 23.6063720703125*e10 + 7.18072509765625*e8,
        (3, 1, -3): 36.3644097222222*e10 + 14.2152777777778*e8 + 3.67361111111111*e6,
        (3, 1, -2): 51.6582790798611*e10 + 23.4019368489583*e8 + 8.421875*e6 + 1.890625*e4,
        (3, 1, -1): -e2/(e2 - 1.0)**5,
        (3, 1, 0):  96.8403244357639*e10 + 53.2151557074653*e8 + 26.4756944444444*e6 + 11.46875*e4 + 4.0*e2 + 1.0,
        (3, 1, 1):  124.026996527778*e10 + 71.4791666666667*e8 + 38.1875*e6 + 16.5*e4 + 9.0*e2,
        (3, 1, 2):  149.09169921875*e10 + 97.048095703125*e8 + 32.296875*e6 + 43.890625*e4,
        (3, 1, 3):  254.317795138889*e10 - 13.3680555555556*e8 + 164.694444444444*e6,
        (3, 1, 4):  -416.388549804688*e10 + 532.960510253906*e8,
        (3, 1, 5):  1567.17015625*e10,
        (3, 2, -5): 1567.17015625*e10,
        (3, 2, -4): -416.388549804688*e10 + 532.960510253906*e8,
        (3, 2, -3): 254.317795138889*e10 - 13.3680555555556*e8 + 164.694444444444*e6,
        (3, 2, -2): 149.09169921875*e10 + 97.048095703125*e8 + 32.296875*e6 + 43.890625*e4,
        (3, 2, -1): 124.026996527778*e10 + 71.4791666666667*e8 + 38.1875*e6 + 16.5*e4 + 9.0*e2,
        (3, 2, 0):  96.8403244357639*e10 + 53.2151557074653*e8 + 26.4756944444444*e6 + 11.46875*e4 + 4.0*e2 + 1.0,
        (3, 2, 1):  -e2/(e2 - 1.0)**5,
        (3, 2, 2):  51.6582790798611*e10 + 23.4019368489583*e8 + 8.421875*e6 + 1.890625*e4,
        (3, 2, 3):  36.3644097222222*e10 + 14.2152777777778*e8 + 3.67361111111111*e6,
        (3, 2, 4):  23.6063720703125*e10 + 7.18072509765625*e8,
        (3, 2, 5):  14.0312673611111*e10,
        (3, 3, -5): 36828.8084027778*e10,
        (3, 3, -4): -68154.558710395*e10 + 8504.77816433377*e8,
        (3, 3, -3): 43691.82890625*e10 - 13126.59375*e8 + 1660.5625*e6,
        (3, 3, -2): -11511.4770507813*e10 + 6597.1491156684*e8 - 2027.36979166667*e6 + 252.015625*e4,
        (3, 3, -1): 1147.2109375*e10 - 1221.72222222222*e8 + 736.916666666667*e6 - 220.0*e4 + 25.0*e2,
        (3, 3, 0):  -31.233955078125*e10 + 68.0408935546875*e8 - 83.21875*e6 + 49.21875*e4 - 12.0*e2 + 1.0,
        (3, 3, 1):  0.136197916666667*e10 - 0.524305555555556*e8 + 1.85416666666667*e6 - 2.5*e4 + e2,
        (3, 3, 2):  0.00393880208333333*e10 + 0.00490993923611111*e8 + 0.00520833333333333*e6 + 0.015625*e4,
        (3, 3, 4):  1.35633680555556e-5*e10 + 6.78168402777778e-6*e8,
        (3, 3, 5):  6.94444444444444e-5*e10,
    }

    return eccentricity_results_bymode


@njit
def eccentricity_funcs_trunc12(eccentricity: np.ndarray) -> Dict[Tuple[int, int, int], np.ndarray]:
    """ Calculates the eccentricity functions (by mode) truncated to e^12 for order-l = 3
    Parameters
    ----------
    eccentricity : np.ndarray
        Orbital Eccentricity
    Returns
    -------
    eccentricity_results_bymode : Dict[Tuple[int, int int], np.ndarray]
    """
    # Eccentricity functions calculated at truncation level 14. Reduced to 12

    # Performance and readability improvements
    e = eccentricity
    e2  = e * e
    e4  = e * e * e * e
    e6  = e * e * e * e * e * e
    e8  = e**8
    e10 = e**10
    e12 = e**12

    eccentricity_results_bymode = {
        (3, 0, -6): 0.000250282287597656*e12,
        (3, 0, -5): 0.000150462962962963*e12 + 6.94444444444444e-5*e10,
        (3, 0, -4): 1.84094464337384e-5*e12 + 1.35633680555556e-5*e10 + 6.78168402777778e-6*e8,
        (3, 0, -2): 0.00329664018419054*e12 + 0.00393880208333333*e10 + 0.00490993923611111*e8 + 0.00520833333333333*e6 + 0.015625*e4,
        (3, 0, -1): 0.0147482638888889*e12 + 0.136197916666667*e10 - 0.524305555555556*e8 + 1.85416666666667*e6 - 2.5*e4 + e2,
        (3, 0, 0):  9.42518173217773*e12 - 31.233955078125*e10 + 68.0408935546875*e8 - 83.21875*e6 + 49.21875*e4 - 12.0*e2 + 1.0,
        (3, 0, 1):  -678.596527777778*e12 + 1147.2109375*e10 - 1221.72222222222*e8 + 736.916666666667*e6 - 220.0*e4 + 25.0*e2,
        (3, 0, 2):  12278.0423667696*e12 - 11511.4770507813*e10 + 6597.1491156684*e8 - 2027.36979166667*e6 + 252.015625*e4,
        (3, 0, 3):  -81727.431640625*e12 + 43691.82890625*e10 - 13126.59375*e8 + 1660.5625*e6,
        (3, 0, 4):  236639.213326379*e12 - 68154.558710395*e10 + 8504.77816433377*e8,
        (3, 0, 5):  -303761.039259259*e12 + 36828.8084027778*e10,
        (3, 0, 6):  141428.145432472*e12,
        (3, 1, -6): 27.3566682721362*e12,
        (3, 1, -5): 38.0982465277778*e12 + 14.0312673611111*e10,
        (3, 1, -4): 55.6978223419189*e12 + 23.6063720703125*e10 + 7.18072509765625*e8,
        (3, 1, -3): 75.7906635802469*e12 + 36.3644097222222*e10 + 14.2152777777778*e8 + 3.67361111111111*e6,
        (3, 1, -2): 99.0341271930271*e12 + 51.6582790798611*e10 + 23.4019368489583*e8 + 8.421875*e6 + 1.890625*e4,
        (3, 1, -1): -e2/(e2 - 1.0)**5,
        (3, 1, 0):  163.495271295618*e12 + 96.8403244357639*e10 + 53.2151557074653*e8 + 26.4756944444444*e6 + 11.46875*e4 + 4.0*e2 + 1.0,
        (3, 1, 1):  201.607039930556*e12 + 124.026996527778*e10 + 71.4791666666667*e8 + 38.1875*e6 + 16.5*e4 + 9.0*e2,
        (3, 1, 2):  240.380771446228*e12 + 149.09169921875*e10 + 97.048095703125*e8 + 32.296875*e6 + 43.890625*e4,
        (3, 1, 3):  246.567255015432*e12 + 254.317795138889*e10 - 13.3680555555556*e8 + 164.694444444444*e6,
        (3, 1, 4):  831.843743430244*e12 - 416.388549804688*e10 + 532.960510253906*e8,
        (3, 1, 5):  -2226.549453125*e12 + 1567.17015625*e10,
        (3, 1, 6):  4308.45518784182*e12,
        (3, 2, -6): 4308.45518784182*e12,
        (3, 2, -5): -2226.549453125*e12 + 1567.17015625*e10,
        (3, 2, -4): 831.843743430244*e12 - 416.388549804688*e10 + 532.960510253906*e8,
        (3, 2, -3): 246.567255015432*e12 + 254.317795138889*e10 - 13.3680555555556*e8 + 164.694444444444*e6,
        (3, 2, -2): 240.380771446228*e12 + 149.09169921875*e10 + 97.048095703125*e8 + 32.296875*e6 + 43.890625*e4,
        (3, 2, -1): 201.607039930556*e12 + 124.026996527778*e10 + 71.4791666666667*e8 + 38.1875*e6 + 16.5*e4 + 9.0*e2,
        (3, 2, 0):  163.495271295618*e12 + 96.8403244357639*e10 + 53.2151557074653*e8 + 26.4756944444444*e6 + 11.46875*e4 + 4.0*e2 + 1.0,
        (3, 2, 1):  -e2/(e2 - 1.0)**5,
        (3, 2, 2):  99.0341271930271*e12 + 51.6582790798611*e10 + 23.4019368489583*e8 + 8.421875*e6 + 1.890625*e4,
        (3, 2, 3):  75.7906635802469*e12 + 36.3644097222222*e10 + 14.2152777777778*e8 + 3.67361111111111*e6,
        (3, 2, 4):  55.6978223419189*e12 + 23.6063720703125*e10 + 7.18072509765625*e8,
        (3, 2, 5):  38.0982465277778*e12 + 14.0312673611111*e10,
        (3, 2, 6):  27.3566682721362*e12,
        (3, 3, -6): 141428.145432472*e12,
        (3, 3, -5): -303761.039259259*e12 + 36828.8084027778*e10,
        (3, 3, -4): 236639.213326379*e12 - 68154.558710395*e10 + 8504.77816433377*e8,
        (3, 3, -3): -81727.431640625*e12 + 43691.82890625*e10 - 13126.59375*e8 + 1660.5625*e6,
        (3, 3, -2): 12278.0423667696*e12 - 11511.4770507813*e10 + 6597.1491156684*e8 - 2027.36979166667*e6 + 252.015625*e4,
        (3, 3, -1): -678.596527777778*e12 + 1147.2109375*e10 - 1221.72222222222*e8 + 736.916666666667*e6 - 220.0*e4 + 25.0*e2,
        (3, 3, 0):  9.42518173217773*e12 - 31.233955078125*e10 + 68.0408935546875*e8 - 83.21875*e6 + 49.21875*e4 - 12.0*e2 + 1.0,
        (3, 3, 1):  0.0147482638888889*e12 + 0.136197916666667*e10 - 0.524305555555556*e8 + 1.85416666666667*e6 - 2.5*e4 + e2,
        (3, 3, 2):  0.00329664018419054*e12 + 0.00393880208333333*e10 + 0.00490993923611111*e8 + 0.00520833333333333*e6 + 0.015625*e4,
        (3, 3, 4):  1.84094464337384e-5*e12 + 1.35633680555556e-5*e10 + 6.78168402777778e-6*e8,
        (3, 3, 5):  0.000150462962962963*e12 + 6.94444444444444e-5*e10,
        (3, 3, 6):  0.000250282287597656*e12,
    }

    return eccentricity_results_bymode


@njit
def eccentricity_funcs_trunc14(eccentricity: np.ndarray) -> Dict[Tuple[int, int, int], np.ndarray]:
    """ Calculates the eccentricity functions (by mode) truncated to e^14 for order-l = 3
    Parameters
    ----------
    eccentricity : np.ndarray
        Orbital Eccentricity
    Returns
    -------
    eccentricity_results_bymode : Dict[Tuple[int, int int], np.ndarray]
    """
    # Eccentricity functions calculated at truncation level 14.

    # Performance and readability improvements
    e = eccentricity
    e2  = e * e
    e4  = e * e * e * e
    e6  = e * e * e * e * e * e
    e8  = e**8
    e10 = e**10
    e12 = e**12
    e14 = e**14

    eccentricity_results_bymode = {
        (3, 0, -7): 0.000644998740236836*e14,
        (3, 0, -6): 0.000536319187709263*e14 + 0.000250282287597656*e12,
        (3, 0, -5): 0.000220803020282187*e14 + 0.000150462962962963*e12 + 6.94444444444444e-5*e10,
        (3, 0, -4): 2.13616319013861e-5*e14 + 1.84094464337384e-5*e12 + 1.35633680555556e-5*e10 + 6.78168402777778e-6*e8,
        (3, 0, -2): 0.00281377997558163*e14 + 0.00329664018419054*e12 + 0.00393880208333333*e10 + 0.00490993923611111*e8 + 0.00520833333333333*e6 + 0.015625*e4,
        (3, 0, -1): 0.0241298776455026*e14 + 0.0147482638888889*e12 + 0.136197916666667*e10 - 0.524305555555556*e8 + 1.85416666666667*e6 - 2.5*e4 + e2,
        (3, 0, 0):  -1.8579429315061*e14 + 9.42518173217773*e12 - 31.233955078125*e10 + 68.0408935546875*e8 - 83.21875*e6 + 49.21875*e4 - 12.0*e2 + 1.0,
        (3, 0, 1):  275.77939401455*e14 - 678.596527777778*e12 + 1147.2109375*e10 - 1221.72222222222*e8 + 736.916666666667*e6 - 220.0*e4 + 25.0*e2,
        (3, 0, 2):  -8750.68870295334*e14 + 12278.0423667696*e12 - 11511.4770507813*e10 + 6597.1491156684*e8 - 2027.36979166667*e6 + 252.015625*e4,
        (3, 0, 3):  97701.9738448661*e14 - 81727.431640625*e12 + 43691.82890625*e10 - 13126.59375*e8 + 1660.5625*e6,
        (3, 0, 4):  -476303.109310042*e14 + 236639.213326379*e12 - 68154.558710395*e10 + 8504.77816433377*e8,
        (3, 0, 5):  1108883.48523754*e14 - 303761.039259259*e12 + 36828.8084027778*e10,
        (3, 0, 6):  -1209861.33836051*e14 + 141428.145432472*e12,
        (3, 0, 7):  496174.887629126*e14,
        (3, 1, -7): 53.1922769850128*e14,
        (3, 1, -6): 58.8906035768082*e14 + 27.3566682721362*e12,
        (3, 1, -5): 83.769890666336*e14 + 38.0982465277778*e12 + 14.0312673611111*e10,
        (3, 1, -4): 109.782940444946*e14 + 55.6978223419189*e12 + 23.6063720703125*e10 + 7.18072509765625*e8,
        (3, 1, -3): 139.202924296599*e14 + 75.7906635802469*e12 + 36.3644097222222*e10 + 14.2152777777778*e8 + 3.67361111111111*e6,
        (3, 1, -2): 172.38474787697*e14 + 99.0341271930271*e12 + 51.6582790798611*e10 + 23.4019368489583*e8 + 8.421875*e6 + 1.890625*e4,
        (3, 1, -1): -e2/(e2 - 1.0)**5,
        (3, 1, 0):  260.314515388356*e14 + 163.495271295618*e12 + 96.8403244357639*e10 + 53.2151557074653*e8 + 26.4756944444444*e6 + 11.46875*e4 + 4.0*e2 + 1.0,
        (3, 1, 1):  311.5595890687*e14 + 201.607039930556*e12 + 124.026996527778*e10 + 71.4791666666667*e8 + 38.1875*e6 + 16.5*e4 + 9.0*e2,
        (3, 1, 2):  363.242660745893*e14 + 240.380771446228*e12 + 149.09169921875*e10 + 97.048095703125*e8 + 32.296875*e6 + 43.890625*e4,
        (3, 1, 3):  424.487224633488*e14 + 246.567255015432*e12 + 254.317795138889*e10 - 13.3680555555556*e8 + 164.694444444444*e6,
        (3, 1, 4):  183.313497563519*e14 + 831.843743430244*e12 - 416.388549804688*e10 + 532.960510253906*e8,
        (3, 1, 5):  3203.3710281808*e14 - 2226.549453125*e12 + 1567.17015625*e10,
        (3, 1, 6):  -8722.04787448412*e14 + 4308.45518784182*e12,
        (3, 1, 7):  11267.6961313067*e14,
        (3, 2, -7): 11267.6961313067*e14,
        (3, 2, -6): -8722.04787448412*e14 + 4308.45518784182*e12,
        (3, 2, -5): 3203.3710281808*e14 - 2226.549453125*e12 + 1567.17015625*e10,
        (3, 2, -4): 183.313497563519*e14 + 831.843743430244*e12 - 416.388549804688*e10 + 532.960510253906*e8,
        (3, 2, -3): 424.487224633488*e14 + 246.567255015432*e12 + 254.317795138889*e10 - 13.3680555555556*e8 + 164.694444444444*e6,
        (3, 2, -2): 363.242660745893*e14 + 240.380771446228*e12 + 149.09169921875*e10 + 97.048095703125*e8 + 32.296875*e6 + 43.890625*e4,
        (3, 2, -1): 311.5595890687*e14 + 201.607039930556*e12 + 124.026996527778*e10 + 71.4791666666667*e8 + 38.1875*e6 + 16.5*e4 + 9.0*e2,
        (3, 2, 0):  260.314515388356*e14 + 163.495271295618*e12 + 96.8403244357639*e10 + 53.2151557074653*e8 + 26.4756944444444*e6 + 11.46875*e4 + 4.0*e2 + 1.0,
        (3, 2, 1):  -e2/(e2 - 1.0)**5,
        (3, 2, 2):  172.38474787697*e14 + 99.0341271930271*e12 + 51.6582790798611*e10 + 23.4019368489583*e8 + 8.421875*e6 + 1.890625*e4,
        (3, 2, 3):  139.202924296599*e14 + 75.7906635802469*e12 + 36.3644097222222*e10 + 14.2152777777778*e8 + 3.67361111111111*e6,
        (3, 2, 4):  109.782940444946*e14 + 55.6978223419189*e12 + 23.6063720703125*e10 + 7.18072509765625*e8,
        (3, 2, 5):  83.769890666336*e14 + 38.0982465277778*e12 + 14.0312673611111*e10,
        (3, 2, 6):  58.8906035768082*e14 + 27.3566682721362*e12,
        (3, 2, 7):  53.1922769850128*e14,
        (3, 3, -7): 496174.887629126*e14,
        (3, 3, -6): -1209861.33836051*e14 + 141428.145432472*e12,
        (3, 3, -5): 1108883.48523754*e14 - 303761.039259259*e12 + 36828.8084027778*e10,
        (3, 3, -4): -476303.109310042*e14 + 236639.213326379*e12 - 68154.558710395*e10 + 8504.77816433377*e8,
        (3, 3, -3): 97701.9738448661*e14 - 81727.431640625*e12 + 43691.82890625*e10 - 13126.59375*e8 + 1660.5625*e6,
        (3, 3, -2): -8750.68870295334*e14 + 12278.0423667696*e12 - 11511.4770507813*e10 + 6597.1491156684*e8 - 2027.36979166667*e6 + 252.015625*e4,
        (3, 3, -1): 275.77939401455*e14 - 678.596527777778*e12 + 1147.2109375*e10 - 1221.72222222222*e8 + 736.916666666667*e6 - 220.0*e4 + 25.0*e2,
        (3, 3, 0):  -1.8579429315061*e14 + 9.42518173217773*e12 - 31.233955078125*e10 + 68.0408935546875*e8 - 83.21875*e6 + 49.21875*e4 - 12.0*e2 + 1.0,
        (3, 3, 1):  0.0241298776455026*e14 + 0.0147482638888889*e12 + 0.136197916666667*e10 - 0.524305555555556*e8 + 1.85416666666667*e6 - 2.5*e4 + e2,
        (3, 3, 2):  0.00281377997558163*e14 + 0.00329664018419054*e12 + 0.00393880208333333*e10 + 0.00490993923611111*e8 + 0.00520833333333333*e6 + 0.015625*e4,
        (3, 3, 4):  2.13616319013861e-5*e14 + 1.84094464337384e-5*e12 + 1.35633680555556e-5*e10 + 6.78168402777778e-6*e8,
        (3, 3, 5):  0.000220803020282187*e14 + 0.000150462962962963*e12 + 6.94444444444444e-5*e10,
        (3, 3, 6):  0.000536319187709263*e14 + 0.000250282287597656*e12,
        (3, 3, 7):  0.000644998740236836*e14,
    }

    return eccentricity_results_bymode