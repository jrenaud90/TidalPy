from typing import Tuple, Dict

import numpy as np

from ...performance import njit

@njit
def eccentricity_funcs_trunc18(eccentricity: np.ndarray) -> Dict[Tuple[int, int, int], np.ndarray]:
    """ Calculates the eccentricity functions (by mode) truncated to e^18

    Parameters
    ----------
    eccentricity : np.ndarray
        Orbital Eccentricity

    Returns
    -------
    eccentricity_results_bymode : Dict[Tuple[int, int int], np.ndarray]

    """
    # Eccentricity functions calculated at truncation level 18.

    # Performance and readability improvements
    e = eccentricity
    e2  = e * e
    e4  = e * e * e * e
    e6  = e * e * e * e * e * e
    e8  = e**8
    e10 = e**10
    e12 = e**12
    e14 = e**14
    e16 = e**16
    e18 = e**18

    eccentricity_results_bymode = {
        (2, 0, -9): 33232930569601*e18/704482010726400,
        (2, 0, -8): 177147*e18/20070400 + 531441*e16/20070400,
        (2, 0, -7): 323974609375*e18/21917218111488 + 2685546875*e16/266355081216 + 244140625*e14/16647192576,
        (2, 0, -6): 3904*e18/382725 + 46*e16/4725 + 16*e14/2025 + 16*e12/2025,
        (2, 0, -5): 8072844669*e18/1315333734400 + 2053593*e16/335544320 + 4284333*e14/734003200 + 6561*e12/1310720 + 6561*e10/1638400,
        (2, 0, -4): 781813*e18/298598400 + 127453*e16/46448640 + 10193*e14/3628800 + 949*e12/345600 + 7*e10/2880 + e8/576,
        (2, 0, -3): 195618433037*e18/410947839590400 + 165074183*e16/317089382400 + 33683687*e14/59454259200 + 64537*e12/106168320 + 619*e10/983040 + 11*e8/18432 + e6/2304,
        (2, 0, -1): 5242619992367*e18/1917756584755200 + 21004537637*e16/6658877030400 + 73185503*e14/19818086400 + 129709*e12/29491200 + 2639*e10/491520 + 113*e8/18432 + 13*e6/768 - e4/16 + e2/4,
        (2, 0, 0):  535500317*e18/37623398400 + 1190849*e16/72253440 + 288163*e14/16934400 + 12791*e12/276480 - 3481*e10/19200 + 2881*e8/2304 - 155*e6/36 + 63*e4/8 - 5*e2 + 1,
        (2, 0, 1):  24490424241*e18/375809638400 - 95982561*e16/469762048 + 176249843*e14/104857600 - 26343519*e12/3276800 + 4654389*e10/163840 - 132635*e8/2048 + 21975*e6/256 - 861*e4/16 + 49*e2/4,
        (2, 0, 2):  -1505096129*e18/182891520 + 77502109*e16/2073600 - 232033433*e14/1814400 + 2459537*e12/7680 - 43773*e10/80 + 83551*e8/144 - 1955*e6/6 + 289*e4/4,
        (2, 0, 3):  1119906455109875*e18/2348273369088 - 15846218478325*e16/12683575296 + 5805813704375*e14/2378170368 - 71300068375*e12/21233664 + 587225375*e10/196608 - 27483625*e8/18432 + 714025*e6/2304,
        (2, 0, 4):  -103512698937*e18/11468800 + 166422047733*e16/11468800 - 1503003091*e14/89600 + 659870313*e12/51200 - 7369791*e10/1280 + 284089*e8/256,
        (2, 0, 5):  1420101409507571189*e18/19568944742400 - 394313641044575*e16/5435817984 + 417304029320899*e14/8493465600 - 140254152605*e12/7077888 + 52142352409*e10/14745600,
        (2, 0, 6):  -77318558814617*e18/274337280 + 578658802849*e16/3386880 - 56914314263*e14/907200 + 5383010161*e12/518400,
        (2, 0, 7):  415947859083950607*e18/751619276800 - 3064748517300717*e16/16441671680 + 147483366698529*e14/5138022400,
        (2, 0, 8):  -176187983600875*e18/334430208 + 402063787225*e16/5308416,
        (2, 0, 9):  6648821549377771726369*e18/34519618525593600,
        (2, 1, -9): 4143587919679849*e18/5261334937600,
        (2, 1, -8): -1606626956771*e18/2167603200 + 31801945561*e16/80281600,
        (2, 1, -7): 999990833612299*e18/2899102924800 - 1328179895713*e16/5033164800 + 186702632281*e14/943718400,
        (2, 1, -6): 41566933*e18/40140800 + 197537355*e16/1605632 - 6926229*e14/89600 + 10029889*e12/102400,
        (2, 1, -5): 2718626226045*e18/52613349376 + 42574868795*e16/1409286144 + 13524196093*e14/264241152 - 2947317*e12/262144 + 3143529*e10/65536,
        (2, 1, -4): 2578148063*e18/51609600 + 27865091*e16/688128 + 1736021*e14/57600 + 708871*e12/25600 + 9933*e10/1280 + 5929*e8/256,
        (2, 1, -3): 9610837422623*e18/187904819200 + 485074233099*e16/11744051200 + 3406598649*e14/104857600 + 32152971*e12/1310720 + 6019881*e10/327680 + 20829*e8/2048 + 2809*e6/256,
        (2, 1, -2): 56670971611*e18/1083801600 + 729537581*e16/17203200 + 13519469*e14/403200 + 525521*e12/20480 + 12027*e10/640 + 1661*e8/128 + 63*e6/8 + 81*e4/16,
        (2, 1, -1): 3798168072196597*e18/71028021657600 + 143189681823*e16/3288334336 + 76230921863*e14/2202009600 + 87480539*e12/3276800 + 3240741*e10/163840 + 28403*e8/2048 + 2295*e6/256 + 81*e4/16 + 9*e2/4,
        (2, 1, 0):  -1/(e2 - 1)**3,
        (2, 1, 1):  3798168072196597*e18/71028021657600 + 143189681823*e16/3288334336 + 76230921863*e14/2202009600 + 87480539*e12/3276800 + 3240741*e10/163840 + 28403*e8/2048 + 2295*e6/256 + 81*e4/16 + 9*e2/4,
        (2, 1, 2):  56670971611*e18/1083801600 + 729537581*e16/17203200 + 13519469*e14/403200 + 525521*e12/20480 + 12027*e10/640 + 1661*e8/128 + 63*e6/8 + 81*e4/16,
        (2, 1, 3):  9610837422623*e18/187904819200 + 485074233099*e16/11744051200 + 3406598649*e14/104857600 + 32152971*e12/1310720 + 6019881*e10/327680 + 20829*e8/2048 + 2809*e6/256,
        (2, 1, 4):  2578148063*e18/51609600 + 27865091*e16/688128 + 1736021*e14/57600 + 708871*e12/25600 + 9933*e10/1280 + 5929*e8/256,
        (2, 1, 5):  2718626226045*e18/52613349376 + 42574868795*e16/1409286144 + 13524196093*e14/264241152 - 2947317*e12/262144 + 3143529*e10/65536,
        (2, 1, 6):  41566933*e18/40140800 + 197537355*e16/1605632 - 6926229*e14/89600 + 10029889*e12/102400,
        (2, 1, 7):  999990833612299*e18/2899102924800 - 1328179895713*e16/5033164800 + 186702632281*e14/943718400,
        (2, 1, 8):  -1606626956771*e18/2167603200 + 31801945561*e16/80281600,
        (2, 1, 9):  4143587919679849*e18/5261334937600,
        (2, 2, -9): 6648821549377771726369*e18/34519618525593600,
        (2, 2, -8): -176187983600875*e18/334430208 + 402063787225*e16/5308416,
        (2, 2, -7): 415947859083950607*e18/751619276800 - 3064748517300717*e16/16441671680 + 147483366698529*e14/5138022400,
        (2, 2, -6): -77318558814617*e18/274337280 + 578658802849*e16/3386880 - 56914314263*e14/907200 + 5383010161*e12/518400,
        (2, 2, -5): 1420101409507571189*e18/19568944742400 - 394313641044575*e16/5435817984 + 417304029320899*e14/8493465600 - 140254152605*e12/7077888 + 52142352409*e10/14745600,
        (2, 2, -4): -103512698937*e18/11468800 + 166422047733*e16/11468800 - 1503003091*e14/89600 + 659870313*e12/51200 - 7369791*e10/1280 + 284089*e8/256,
        (2, 2, -3): 1119906455109875*e18/2348273369088 - 15846218478325*e16/12683575296 + 5805813704375*e14/2378170368 - 71300068375*e12/21233664 + 587225375*e10/196608 - 27483625*e8/18432 + 714025*e6/2304,
        (2, 2, -2): -1505096129*e18/182891520 + 77502109*e16/2073600 - 232033433*e14/1814400 + 2459537*e12/7680 - 43773*e10/80 + 83551*e8/144 - 1955*e6/6 + 289*e4/4,
        (2, 2, -1): 24490424241*e18/375809638400 - 95982561*e16/469762048 + 176249843*e14/104857600 - 26343519*e12/3276800 + 4654389*e10/163840 - 132635*e8/2048 + 21975*e6/256 - 861*e4/16 + 49*e2/4,
        (2, 2, 0):  535500317*e18/37623398400 + 1190849*e16/72253440 + 288163*e14/16934400 + 12791*e12/276480 - 3481*e10/19200 + 2881*e8/2304 - 155*e6/36 + 63*e4/8 - 5*e2 + 1,
        (2, 2, 1):  5242619992367*e18/1917756584755200 + 21004537637*e16/6658877030400 + 73185503*e14/19818086400 + 129709*e12/29491200 + 2639*e10/491520 + 113*e8/18432 + 13*e6/768 - e4/16 + e2/4,
        (2, 2, 3):  195618433037*e18/410947839590400 + 165074183*e16/317089382400 + 33683687*e14/59454259200 + 64537*e12/106168320 + 619*e10/983040 + 11*e8/18432 + e6/2304,
        (2, 2, 4):  781813*e18/298598400 + 127453*e16/46448640 + 10193*e14/3628800 + 949*e12/345600 + 7*e10/2880 + e8/576,
        (2, 2, 5):  8072844669*e18/1315333734400 + 2053593*e16/335544320 + 4284333*e14/734003200 + 6561*e12/1310720 + 6561*e10/1638400,
        (2, 2, 6):  3904*e18/382725 + 46*e16/4725 + 16*e14/2025 + 16*e12/2025,
        (2, 2, 7):  323974609375*e18/21917218111488 + 2685546875*e16/266355081216 + 244140625*e14/16647192576,
        (2, 2, 8):  177147*e18/20070400 + 531441*e16/20070400,
        (2, 2, 9):  33232930569601*e18/704482010726400,
    }

    return eccentricity_results_bymode
